---
name: presentation-pdf-export
description: PDF document generator for a HTML-based presentation generated by the presentation-manager skill.
allowed-tools: Read, Write, Bash, Glob
---

# PDF document generator from a HTML-based presentation

## Instructions

Generate a PDF version of a presentation using Puppeteer and the existing generate-pdf script.

**Use me for**:
- **PDF export based on an HTML-based presentation setup**: Create a printable PDF version of the HTML-based presentation slides.

When generating the PDF, the first step is to create the folder structure for the PDF generation task as described below:

**Critical Files**:
- `scripts/generate-pdf.js` - Script that generates a PDF document from a single-page HTML document (automatically created by the script)
- `templates/package.json` - package.json for the npm dependencies (e.g. Puppeteer)

These files MUST be copied AS-IS to the target workspace where the HTML-based presentation is also located. The script handles the creation of temporary HTML files automatically. 

## Arguments Expected

The user will provide:
1. **presentation** - The presentation name (e.g., "coroutines", "interop-testing-framework-integration")

## Workspace Setup Phase

Before generating the PDF, ensure the target workspace has the required files and structure:

### 1. **Verify Directory Structure**:
Check if the presentation follows the expected structure:
```
workspace/
â”œâ”€â”€ slides/
â”‚   â”œâ”€â”€ {presentation}.html         # Main presentation file
â”‚   â””â”€â”€ {presentation}/             # Presentation directory
â”‚       â””â”€â”€ {topic-folders}/        # Topic folders with HTML slides
â””â”€â”€ scripts/                        # Will be created if missing
```

### 2. **Copy Required Files**:
If `scripts/` directory doesn't exist or is missing required files:

- **Create scripts directory**:
  ```bash
  mkdir -p scripts
  ```

- **Copy PDF generation script**:
  Copy from `skills/scripts/generate-pdf.js` to `scripts/generate-pdf.js`

- **Copy package.json**:
  Copy from `skills/templates/package.json` to `scripts/package.json`

### 3. **Install Dependencies**:
Check if `node_modules/` exists in the scripts directory:
```bash
cd scripts && npm install
```

### 4. **Validate Presentation Files**:
Before proceeding, verify:
- âœ“ `slides/{presentation}.html` exists
- âœ“ `slides/{presentation}/` directory exists
- âœ“ Presentation contains `categorySlides` object
- âœ“ Referenced slide files exist

## Full documentation

Follow these steps to generate a PDF:

1. **Parse user input**:
    - Extract presentation name
    - If not provided, show available presentations and ask which one

2. **Validate prerequisites**:
    - Check if `scripts/package.json` exists
    - Check if `scripts/generate-pdf.js` exists
    - Check if presentation HTML file exists
    - Check if `node_modules/` exists

3. **Check for missing dependencies**:
   If `node_modules/` doesn't exist:
   ```
   ğŸ“¦ Installing dependencies first...
   ```
   Run: `npm install`

4. **Run the PDF generation script**:
   ```bash
   node scripts/generate-pdf.js {presentation}
   ```

5. **Monitor the process**:
    - Show progress updates from the script
    - Watch for errors
    - Display completion status

6. **Report results**:
   ```
   âœ… PDF generated successfully!

   ğŸ“ Location: {presentation}.pdf
   ğŸ“Š Total slides: {count}
   ğŸ“¦ File size: {size} KB

   ğŸ’¡ The PDF includes:
      â€¢ All slides with brand colors
      â€¢ Raleway font typography
      â€¢ Logo on each slide
      â€¢ Syntax-highlighted code blocks
      â€¢ Print-optimized layout (1200x800px)
   ```

## Example Usage

```
User: generate PDF for coroutines
```

Expected behavior:
1. Validate prerequisites
2. Run: `node scripts/generate-pdf.js {presentation}`
3. Monitor output
4. Report success with file location and details

## Troubleshooting

### If Puppeteer fails:
```
âŒ Puppeteer error: Could not find Chrome

Try installing Chrome or updating the executablePath in scripts/generate-pdf.js

Current path: /Applications/Google Chrome.app/Contents/MacOS/Google Chrome
```

### If slides are missing:
```
âš ï¸ Warning: Some slides referenced in categorySlides were not found

Missing slides:
  â€¢ slides/coroutines/flow/missing-slide.html

PDF will be generated with available slides only.
```

### If script is missing:
```
âŒ Error: PDF generation script not found

Expected: scripts/generate-pdf.js

Please ensure the script exists before running this command.
```

## Pre-Generation Validation

Before generating PDF, optionally validate:

1. **Check for missing slides**:
   ```
   ğŸ” Validating slide structure...
   âœ“ All 60 slides found
   âœ“ All code blocks have language classes
   âœ“ All topics have title pages
   ```

2. **Warn about potential issues**:
   ```
   âš ï¸ Potential Issues:
      â€¢ 3 code blocks missing language class (won't be highlighted)
      â€¢ 1 slide has very long code (may overflow)

   Continue with PDF generation? (y/n)
   ```

## Post-Generation Actions

After successful generation:

```
âœ… PDF generated successfully!

ğŸ“ Location: coroutines.pdf

ğŸ’¡ Next steps:
   â€¢ Open PDF: open coroutines.pdf
   â€¢ View slides: ls -lh coroutines.pdf

ğŸ“¤ Ready to distribute:
   â€¢ PDF includes all branding
   â€¢ All slides are print-ready
   â€¢ Syntax highlighting applied
```


## Important Notes

- The script uses Puppeteer with Chrome headless
- Generated PDFs include Prism.js syntax highlighting
- Each slide is 1200x800px
- Brand colors and Raleway font are embedded
- Process may take 10-30 seconds depending on slide count
- Temporary HTML file is created and cleaned up automatically

## Error Recovery

If generation fails:
1. Show full error message from script
2. Check if temporary files need cleanup
3. Suggest potential fixes
4. Offer to retry

```
âŒ PDF generation failed

Error: Timeout waiting for Prism.js

Possible fixes:
  â€¢ Check internet connection (Prism.js loaded from CDN)
  â€¢ Increase timeout in generate-pdf.js
  â€¢ Try again: /generate-pdf coroutines

Retry now? (y/n)
```